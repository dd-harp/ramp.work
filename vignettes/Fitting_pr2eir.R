## -----------------------------------------------------------------------------
library(knitr)
library(ramp.xds)
library(ramp.work)

## ----show_pr------------------------------------------------------------------
show_pr = function(model, get_pr=F_pr, i=1){
  y = unname(get_inits(model))
  get_pr(list_Xvars(y, model, 1), model$Xpar[[1]])
}

## -----------------------------------------------------------------------------
si <- dts_setup(Xname = "SIS", MYZname = "si")

## -----------------------------------------------------------------------------
show_pr(si)

## -----------------------------------------------------------------------------
si <- dts_init_by_pr(.4, si, F_pr, 365)
show_pr(si)

## -----------------------------------------------------------------------------
ar <- dts_pr2ar_step(.4, si, F_pr)
ar

## -----------------------------------------------------------------------------
set.seed(230)
ar_ts <- ar*c(1, rlnorm(14, 1, 1))
ar_ts

## -----------------------------------------------------------------------------
si1 = si
pr_ts = show_pr(si1)
for(i in 2:length(ar_ts)){
  y = update_by_ar(ar_ts[i], si1, 1)
  si1 = update_inits(y, si1)
  pr_ts = c(pr_ts, show_pr(si1))
}
pr_ts

## -----------------------------------------------------------------------------
ar_t <- dts_pr2ar_ts(pr_ts, si, F_pr)
sum((ar_ts-ar_t)^2) < 1e-9

